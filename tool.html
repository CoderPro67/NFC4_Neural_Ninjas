<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Data Privacy Redaction Tool</title>
    <link rel="stylesheet" href="./index.css">
</head>
<body>

    <header class="hero-section" id="hero-section">
        <div class="container">
            <nav class="navbar">
                <a href="#" class="logo">Data Redact AI</a>
                <ul class="nav-links">
                    <li><a href="#features">Features</a></li>
                    <li><a href="#solution">Solution</a></li>
                    <li><a href="#login">Login</a></li>
                </ul>
            </nav>
            <div class="hero-content">
                <h1>Automate Data Privacy Redaction with Intelligent AI</h1>
                <p>Securely share documents by automatically redacting sensitive information while preserving context and readability. Save time and ensure compliance.</p>

                <div class="upload-options">
                    <div class="option-group">
                        <label for="compliance-mode">Compliance Mode:</label>
                        <select id="compliance-mode" name="mode">
                            <option value="DPDP" selected>DPDP (India)</option>
                            <option value="GDPR">GDPR (Europe)</option>
                            <option value="HIPAA">HIPAA (Health, US)</option>
                            <option value="FULL_REDACTION">Full Redaction</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label for="agentic-level">Confidence Level: <span id="level-value">0.75</span></label>
                        <input type="range" id="agentic-level" name="level" min="0.1" max="1.0" step="0.05" value="0.75">
                    </div>
                    <div class="option-group checkbox-group">
                        <label for="aggressive-mode">Aggressive Mode</label>
                        <input type="checkbox" id="aggressive-mode" name="aggressive">
                        <span>(Redacts all detected entities regardless of confidence)</span>
                    </div>
                </div>
                <button class="btn upload-btn" id="upload-btn">Upload & Redact</button>
                <input type="file" id="file-input" style="display: none;" accept=".txt,.pdf,.docx,.json">
            </div>
        </div>
    </header>

    <section id="features" class="features-section">
        <div class="container">
            <h2>Key Functionalities</h2>
            <div class="features-grid">
                <div class="feature-card" onclick="showFormatSelection()">
                    <div class="icon">üìÑ</div>
                    <h3>Supports Multiple Document Formats</h3>
                    <p>(TXT, DOCX, PDF, JSON)</p>
                </div>
                <div class="feature-card">
                    <div class="icon">ü§ñ</div>
                    <h3>AI-Powered PII Detection</h3>
                    <p>Accurately identifies personally identifiable information.</p>
                </div>
                <div class="feature-card">
                    <div class="icon">‚öôÔ∏è</div>
                    <h3>Customizable Redaction</h3>
                    <p>Tailor redaction with modes and confidence levels.</p>
                </div>
                <div class="feature-card">
                    <div class="icon">‚úçÔ∏è</div>
                    <h3>Manual Override</h3>
                    <p>Fine-tune redactions for complete control.</p>
                </div>
                <div class="feature-card">
                    <div class="icon">‚öñÔ∏è</div>
                    <h3>Compliance Modes</h3>
                    <p>GDPR, HIPAA, DPDP, and more.</p>
                </div>
                <div class="feature-card">
                    <div class="icon">üìÅ</div>
                    <h3>Batch Redaction</h3>
                    <p>Process multiple documents at once.</p>
                </div>
            </div>
        </div>
    </section>
    
    <section id="format-selection-page" class="format-selection-section hidden">
        <div class="container">
            <button class="back-btn" onclick="backToFeatures()">&larr; Back to Features</button>
            <h2>Choose a File Format to Upload</h2>
            <p>Select a format to proceed with the redaction process.</p>
            <div class="format-grid">
                <button class="format-btn" onclick="uploadFile('.txt')">TXT</button>
                <button class="format-btn" onclick="uploadFile('.docx')">DOCX</button>
                <button class="format-btn" onclick="uploadFile('.pdf')">PDF</button>
                <button class="format-btn" onclick="uploadFile('.json')">JSON</button>
            </div>
        </div>
    </section>

    <section id="redaction-view" class="redaction-view hidden">
        <div class="container">
            <button class="back-btn" onclick="backToHome()">&larr; Upload Another File</button>
            <h2>Review & Validate Redaction</h2>
            <div class="redaction-panel">
                <div class="document-pane original-document">
                    <h3>Original Document</h3>
                    <pre id="original-text"></pre>
                </div>
                <div class="document-pane redacted-document">
                    <h3>Redacted Document</h3>
                    <pre id="redacted-text"></pre>
                </div>
            </div>
            <button class="btn validate-btn" id="validate-btn">Download Redacted File</button>
        </div>
    </section>

    <section id="solution" class="solution-section">
        <div class="container">
            <div class="solution-content">
                <div class="solution-text">
                    <h2>Intelligently redact sensitive information while preserving document meaning.</h2>
                    <p>Manual redaction is labor-intensive, error-prone, and can obscure the original document's purpose. Our AI tool automates this process, ensuring accuracy and efficiency while preserving the context and readability that matters.</p>
                </div>
                <div class="solution-image">
                    <img src="https://storage.googleapis.com/gemini-prod/images/41551c6b-87b6-45e0-b695-1f52d9a584de.png" alt="Before and after redaction comparison">
                </div>
            </div>
        </div>
    </section>

    <section id="login" class="login-section">
        <div class="container">
            <h2>Login</h2>
            <p>Access your account to start redacting documents.</p>
            <form action="#" method="post" class="login-form">
                <input type="email" name="email" placeholder="Email Address" required>
                <input type="password" name="password" placeholder="Password" required>
                <button type="submit" class="btn">Log In</button>
            </form>
            <p class="signup-link">Don't have an account? <a href="#">Sign up here</a></p>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-links">
                <a href="#">Privacy Policy</a>
                <a href="#">Terms of Service</a>
            </div>
            <p>&copy; 2025 Data Redact AI. All rights reserved.</p>
        </div>
    </footer>

    <script>
        document.getElementById('upload-btn').addEventListener('click', function() {
            document.getElementById('file-input').click();
        });

        // MODIFIED: This entire event listener is updated to send the new parameters.
        document.getElementById('file-input').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (!file) return;

            // Get values from the new UI controls
            const mode = document.getElementById('compliance-mode').value;
            const level = document.getElementById('agentic-level').value;
            const aggressive = document.getElementById('aggressive-mode').checked;

            const formData = new FormData();
            formData.append("file", file);
            // Append the new parameters to the form data
            formData.append("mode", mode);
            formData.append("level", level);
            formData.append("aggressive", String(aggressive)); // Send as string for compatibility

            console.log("Uploading with params:", { mode, level, aggressive }); // For debugging

            fetch("http://127.0.0.1:8000/upload", {
                method: "POST",
                body: formData
            })
            .then(response => {
                if (!response.ok) {
                    // Handle HTTP errors like 4xx, 5xx. Assumes server sends JSON error.
                    return response.json().then(err => { throw new Error(err.detail || err.error || 'Server error occurred') });
                }
                return response.json();
            })
            .then(data => {
                if (data.status === 'error') {
                    // Handle logical errors returned by the backend
                    alert(`An error occurred: ${data.error}`);
                    return;
                }
                const originalText = data.original_text || "No original text to display.";
                const redactedText = data.redacted_text || "No redacted text to display.";
                showRedactionView(originalText, redactedText);
            })
            .catch(error => {
                console.error("Error uploading file:", error);
                alert("Could not process the file. " + error.message);
            });
        });

        // NEW: Add a listener for the slider to update the displayed value in real-time.
        document.getElementById('agentic-level').addEventListener('input', function(event) {
            document.getElementById('level-value').textContent = event.target.value;
        });

        document.getElementById('validate-btn').addEventListener('click', function() {
            alert('Redaction validated! Your redacted file is ready for download.');
            // In a real application, this would trigger a file download.
        });
        
        function showRedactionView(originalText, redactedText) {
            // Hide main landing page sections
            document.getElementById('hero-section').classList.add('hidden');
            document.getElementById('features').classList.add('hidden');
            document.getElementById('solution').classList.add('hidden');
            document.getElementById('login').classList.add('hidden');
            document.getElementById('format-selection-page').classList.add('hidden');


            // Show redaction view
            document.getElementById('redaction-view').classList.remove('hidden');
            document.getElementById('original-text').textContent = originalText;
            document.getElementById('redacted-text').textContent = redactedText;
        }

        function backToHome() {
            document.getElementById('hero-section').classList.remove('hidden');
            document.getElementById('features').classList.remove('hidden');
            document.getElementById('solution').classList.remove('hidden');
            document.getElementById('login').classList.remove('hidden');
            document.getElementById('redaction-view').classList.add('hidden');
            
            // Reset file input so user can upload the same file again if needed
            document.getElementById('file-input').value = '';
        }

        function showFormatSelection() {
            document.getElementById('hero-section').classList.add('hidden');
            document.getElementById('features').classList.add('hidden');
            document.getElementById('solution').classList.add('hidden');
            document.getElementById('login').classList.add('hidden');
            document.getElementById('format-selection-page').classList.remove('hidden');
        }

        function backToFeatures() {
            document.getElementById('hero-section').classList.remove('hidden');
            document.getElementById('features').classList.remove('hidden');
            document.getElementById('solution').classList.remove('hidden');
            document.getElementById('login').classList.remove('hidden');
            document.getElementById('format-selection-page').classList.add('hidden');
        }

        function uploadFile(fileType) {
            const fileInput = document.getElementById('file-input');
            fileInput.accept = fileType;
            fileInput.click();
        }
    </script>

</body>
</html>